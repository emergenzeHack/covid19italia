---
layout: homepage
title: Covid19Italia Help
lang: it
subtitle: Un progetto per condividere informazioni e attivarsi a supporto dell'emergenza COVID19
---
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
   integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
   crossorigin=""/>

   <!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
   integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
   crossorigin=""></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css"
   crossorigin=""/>

<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css"
   crossorigin=""/>

 <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"
   crossorigin=""></script>

<script type="application/ld+json">
    [{
        "@context": "http://schema.org",
        "@type":"Project",
        "name": "Covid19Italia.help",
        "knowsAbout" : "covid19italia.help è un progetto no profit, organizzato e diretto interamente da volontari e volontarie. È nato per condividere informazioni utili e verificate sull’evento di Coronavirus diffusosi in Italia nel 2020.",
        "url": "https://www.covid19italia.help/",
        "image": "https://www.covid19italia.help/images/covid19italia-full.png",

        "description": "covid19italia.help è un progetto no profit, organizzato e diretto interamente da volontari e volontarie. È nato per condividere informazioni utili e verificate sull’evento di Coronavirus diffusosi in Italia nel 2020.",
        "ownershipFundingInfo"  : {
            "@type" : "AboutPage",
            "url" : ["https://www.covid19italia.help/about/"]
        },
        "sameAs": ["https://www.facebook.com/covid19italia.help", "https://github.com/emergenzeHack/covid19italia", "https://twitter.com/ItaliaCovid19", "https://www.instagram.com/covid19italia.help"]
    },
        {
            "@context": "http://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [{
                "@type": "ListItem",
                "position": 1,
                "item": {
                    "@id": "https://www.covid19italia.help/",
                    "name": "Home"
                }
            },{
                "@type": "ListItem",
                "position": 2,
                "item": {
                    "@id": "https://www.covid19italia.help/issues/",
                    "name": "Segnalazioni"
                }
            },{
                "@type": "ListItem",
                "position": 3,
                "item": {
                    "@id": "https://www.covid19italia.help/issues/regione/",
                    "name": "Segnalazioni per regione"
                }
            },{
                "@type": "ListItem",
                "position": 4,
                "item": {
                    "@id": "https://www.covid19italia.help/segnala/",
                    "name": "Segnala"
                }
            },{
                "@type": "ListItem",
                "position": 5,
                "item": {
                    "@id": "https://www.covid19italia.help/about/",
                    "name": "Chi siamo"
                }
            },{
                "@type": "ListItem",
                "position": 6,
                "item": {
                    "@id": "https://www.covid19italia.help/contribuisci/",
                    "name": "Contribuisci"
                }
            }]
        }]
</script>

<div class="row">
    <div class="col-12">
        <div class="homepage-categories mt-4">
            {% assign categories_without_map = site.data.cfg.logos | where: "map", false %}
            {% for category in categories_without_map %}
            {% capture logo_alt %}
            {{ category.name }}
            {% if category.logo_credit and category.logo_credit != empty %}
            logo by {{ category.logo_credit }}
            {% endif %}
            {% endcapture %}
            {% assign logo_alt = logo_alt | strip %}
            {% if site.lang == "it" %}
            {% assign linkProperty = 'link' %}
            {%else%}
            {% assign linkProperty = 'link_' | append : site.lang %}
            {% endif %}
            {% assign link = category[linkProperty] %}
            {% if link and link != empty %}
            <a href="{{ site.baseurl }}/{{ link }}" title="{{ logo_alt }}">
                <div class="card border-0" style="width: 10rem;">
                    {% if category.logo and category.logo != empty %}
                    <img class="card-img-top w-50 mx-auto" src="{{ site.baseurl }}{{ category.logo }}" alt="{{ category.logo-alt }}">
                    {% endif %}
                    <div class="card-body w-100">
                        <h6 class="card-title">{{ category.name }}</h6>
                    </div>
                </div>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12 w-100 mb-15">
		<form class="global-search" role="form" action="/searchissues" method="get">
			<div class="input-group">
				<input type="text" class="form-control" id="search-box" name="query" placeholder="Cosa cerchi?">
				<div class="input-group-btn">
                                    <button class="btn btn-primary" type="submit"><span><i class="glyphicon glyphicon-search"></i> Cerca tra {{site.data.machgen.issuesjson.size}} segnalazioni</span></button>
				</div>
			</div>
		</form>
    </div>
</div>

<div class="row">
    <div class="col-12 my-auto">
        <div id="map" class="w-100 my-auto" style="height: 500px;"></div> 
    </div>
</div>

<hr class="col-lg-12">


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../js/moment.min.js"></script>
<script type="text/javascript" src="../js/masonry.min.js"></script>
<!-- form di ricerca delle news -->
<script src="../js/jquery.sieve.min.js" type="text/javascript"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.5/elasticlunr.min.js"></script>
<script type="text/javascript" src="../js/lunr.stemmer.support.min.js"></script>
<script type="text/javascript" src="../js/lunr.it.min.js"></script>
<script type="text/javascript" src="../js/search.min.js"></script>

<script>
  var searchTemplate="<div class='form-group'><div class='input-group'><div class='input-group-addon'>Cerca:</div><input type='text' class='form-control' placeholder='(cerca qui...)'></div></div>"
  $("div.sieve").sieve({ itemSelector: ".panel-info" });
</script>


{%- assign filteredissues = site.data.machgen.issuesjson | where: "state","open" -%}

<script>
var markerList=[];

{%- for member in filteredissues -%} 
    {%- if member.issue.lat != blank and member.issue.lon != blank -%} 
        markerList.push([{{member.issue.lat}}, {{member.issue.lon}}, "{{member.title|uri_escape}}", "{{ member.number }}", {{member.issue.labels}}]);
    {%- endif -%} 
{%- endfor -%} 

// define icons
var markerIcons = {};
{% for category in site.data.cfg.issuecategories %}
var newMarker = L.AwesomeMarkers.icon({icon: "{{category['markericon']}}", markerColor: "{{category['markercolor']}}", prefix: 'fa'}); // iniziative solidali pubbliche e private
markerIcons["{{category['labelname']}}"]=newMarker;
{% endfor %}
var iconaDefault = L.AwesomeMarkers.icon({icon: '', markerColor: 'darkpurple'});

// initialize the map
var map = L.map('map', {
  scrollWheelZoom: false
})

// create the tile layer with correct attribution
var osmUrl='{{site.tile_map}}';
var osmAttrib='&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>';
var osm = new L.TileLayer(osmUrl, {minZoom: {{site.issuemap.zoom}}>1?{{site.issuemap.zoom}}-1:{{site.issuemap.zoom}}, maxZoom: 19, attribution: osmAttrib});


var sumLat = 0.;
var sumLon = 0.;

markers = L.markerClusterGroup();

for (var i=0; i<markerList.length; i++) {
    var lat = markerList[i][0];
    var lon = markerList[i][1];
    var popupText = markerList[i][2];
    var popupURL = markerList[i][3];
    var labels = markerList[i][4];
    var iconaFinale = iconaDefault;

    // Raccolte fondi, Supporto psicologico, Servizi e iniziative solidali pubbliche, Servizi e iniziative solidali private, Richiesta aiuto

    for (var il = 0; il < labels.length; il++) {
        if (labels[il] in markerIcons) {
            iconaFinale = markerIcons[labels[il]]
            break;
        }
    }

    if (!isNaN(lat) && !isNaN(lon)) {
        var markerLocation = new L.LatLng(lat, lon);
        var marker = new L.Marker(markerLocation, {icon: iconaFinale});

        markers.addLayer(marker);

        marker.bindPopup("<a href=\"/issues/" + popupURL + "\">" + decodeURI(popupText) + "</a>");

        sumLat += lat;
        sumLon += lon;
    }
}

map.addLayer(markers);

map.addLayer(osm).setView([{{site.issuemap.center}}], {{site.issuemap.zoom}});

//var group = new L.featureGroup([marker1, marker2, marker3]);

{% if page.fitBounds %}
map.fitBounds(markers.getBounds().pad(0.3));
{% endif %}

function getFeaturesInView() {
    //console.log("getFeaturesInView");
    var featuresInView = [];
    var featuresNotInView = [];
    for (var i=0; i<markerList.length; i++) {
        if(map.getBounds().contains(L.latLng(markerList[i][0],markerList[i][1]))) {
            featuresInView.push(markerList[i]);
        } else {
            featuresNotInView.push(markerList[i]);
        }
    }
    return [featuresInView,featuresNotInView];
}

function setVisible(element) {
    $("#issue"+element[3]).show();
    //console.log("Show #issue"+element[3]);
}
function setInVisible(element) {
    $("#issue"+element[3]).hide();
    //console.log("Hide #issue"+element[3]);
}

function onMoveEnd(evt) {
    [inView,notInView]=getFeaturesInView();
    console.log(notInView);
    console.log(inView);
    notInView.forEach(setInVisible);
    inView.forEach(setVisible);
}

map.on('moveend', onMoveEnd);

//var geocoder = L.Control.geocoder({collapsed:false,placeholder:"Cerca...",
//        defaultMarkGeocode: false, geocodingQueryParams: { countrycodes: "it" },
//        })
//.on('markgeocode', function(e) {
//        var latlon=e.geocode.center;
//        $("#lat").html(latlon.lat);
//        $("#lng").html(latlon.lng);
//        var marker = new L.Marker(markerLocation);
//        map.addLayer(marker);
//        })
//.addTo(map);

/**
 * Get the URL parameters
 * source: https://css-tricks.com/snippets/javascript/get-url-variables/
 * @param  {String} url The URL
 * @return {Object}     The URL parameters
 */
var getParams = function (url) {
	var params = {};
	var parser = document.createElement('a');
	parser.href = url;
	var query = parser.search.substring(1);
	var vars = query.split('&');
	for (var i = 0; i < vars.length; i++) {
		var pair = vars[i].split('=');
		params[pair[0]] = decodeURIComponent(pair[1]);
	}
	return params;
};

function processParams (){
        params = getParams(window.location.href);
        //console.log(params);
}

window.onload = processParams;

</script>
